# Z-Image 分层融合插件

## 文件结构

```
comfyui_nodes/
├── __init__.py           # ComfyUI 插件入口
├── zimage_layer_merge.py # 节点实现
└── README.md            # 使用文档

scripts/
└── merge_zimage_layers.py # 独立CLI工具
```

## 节点列表

| 节点 | 功能 |
|------|------|
| Z-Image Layer Merge | 按层范围融合 + 渐变模式 |
| Z-Image Layer Merge (Per-Layer) | 30层独立ratio |
| Z-Image Layer Merge (By Block) | 按attention/FFN/norm分别控制 |
| Z-Image Model Save | 保存融合结果 |

## CLI 使用

```bash
# 基础
python scripts/merge_zimage_layers.py model_a model_b -o merged.safetensors

# 前半层用A，后半层用B
python scripts/merge_zimage_layers.py model_a model_b --layers 15-29 --ratio 1.0 -o merged.safetensors

# 只融合attention
python scripts/merge_zimage_layers.py model_a model_b --block qkv=0.7 out=0.7 ffn=0 -o merged.safetensors
```
